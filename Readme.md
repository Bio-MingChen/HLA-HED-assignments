# ä¸‹è½½ HLA å„ä¸ªå‹åˆ«æ°¨åŸºé…¸åºåˆ—

https://www.ebi.ac.uk/ipd/imgt/hla/download/

ä½¿ç”¨ filezilla è¿›è¡Œä¸‹è½½ï¼š
![alt text](image.png)

æ°¨åŸºé…¸åºåˆ—ä½ç½®ï¼š/pub/databases/ipd/imgt/hla/fasta
å®Œæ•´æ°¨åŸºé…¸åºåˆ—æ–‡ä»¶ï¼š/pub/databases/ipd/imgt/hla/hla_prot.fasta
HLA åŸºå› åŠŸèƒ½æ³¨é‡Šæ–‡ä»¶ï¼š/pub/databases/ipd/imgt/hla/hla.dat
HED å‚è€ƒä»“åº“ï¼šhttps://github.com/sunhuaibo/HLA-HED

# åˆ†æè®°å½• 20250612

## æ–‡ä»¶è¯´æ˜

é€šè¿‡è„šæœ¬[dat_parse_debug.py](./data/dat_parse_debug.py)å¾—åˆ°åˆ° HLA Class I å’Œ Class II çš„ exon2/3 æ°¨åŸºé…¸åºåˆ—ï¼š [hla_exon_sequences.fasta](./data/hla_exon_sequences.fasta)
æ–‡çŒ® github ä»“åº“çš„ HLA ABC åŸºå› çš„ exon2/3 æ°¨åŸºé…¸åºåˆ—ï¼š[ABC_prot.fa](./data/ABC_prot.fa)

## åˆ†æè¯´æ˜

- é€šè¿‡è„šæœ¬[validate_results.py](./validate_results.py) éªŒè¯ï¼Œæˆ‘ä»¬æ‰¾åˆ°çš„ ABC ä¸‰ä¸ªåŸºå› çš„æ•°é‡ä¸æ–‡çŒ®æä¾›çš„æ–‡ä»¶æ•°é‡åŸºæœ¬ä¸€è‡´ï¼Œä¸åŒçš„å‡ ä¸ªå‹åˆ«ä¸»è¦æ˜¯ç»“å°¾æ˜¯ N çš„ç±»å‹ä»¥åŠç»“å°¾æ˜¯ Q çš„ç±»å‹ï¼Œæˆ‘ä»¬åœ¨è¾“å‡ºç»“æœçš„æ—¶å€™è¿‡æ»¤äº†ç»“å°¾æ˜¯ N çš„å‹åˆ«ï¼Œå› ä¸ºå®ƒä»¬è¢«è®¤ä¸ºä¸è¡¨è¾¾ï¼Œè€Œ Q ä»£è¡¨ç–‘ä¼¼ç¼–ç è›‹ç™½åŠŸèƒ½å¼‚å¸¸ï¼ˆQuestionable expressionï¼‰ã€‚æˆ‘å‘ç°**A\*26:166Q**åœ¨æˆ‘ä¸‹è½½çš„[hla.dat](./data/hla.dat)ä¸­æ˜¯ä¸å¸¦ Q çš„ï¼Œè€Œåœ¨[ABC_prot.fa](./data/ABC_prot.fa)ä¸­æ˜¯å¸¦ Q çš„ï¼Œæˆ‘æ¨æµ‹æ˜¯ç‰ˆæœ¬æ›´æ–°çš„é—®é¢˜ã€‚
  éªŒè¯ç»“æœæˆªå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š
  ![alt text](image-1.png)

- æˆ‘åœ¨è®¡ç®— HED çš„æ—¶å€™ï¼Œå‘ç°æ¯ä¸ªåŸºå› çš„å„ä¸ªç­‰ä½åŸºå› çš„é•¿åº¦ä¸ä¸€è‡´ï¼Œé•¿åº¦ç»Ÿè®¡è¯·è§[hla_seq_length_stats_by_gene.txt](./data/hla_seq_length_stats_by_gene.txt)

- æ£€æŸ¥åå‘ç°ï¼Œé•¿åº¦ä¸ä¸€è‡´çš„éƒ½æ˜¯ Q ç»“å°¾çš„ï¼Œä¹Ÿå°±æ˜¯ questionable expressionï¼Œè€Œä¸”å®ƒä»¬éƒ½ä¸åœ¨[ABC_prot.fa](./data/ABC_prot.fa)ä¸­ï¼Œå› æ­¤æˆ‘æ¨æ–­ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿ç•™å’Œè®¡ç®—é•¿åº¦ä¸€è‡´çš„åŸºå› åºåˆ—çš„ HED å³å¯ã€‚

- å…³äº HED æ‰€ä»£è¡¨çš„å«ä¹‰ï¼Œä»¥åŠä¸ºä»€ä¹ˆå®ƒè¦é™¤ä»¥ 2.2,ChatGPT çš„æ£€ç´¢ç»“æœå¦‚ä¸‹ï¼š

è¿™å¥è¯çš„æ„æ€æ˜¯ï¼š**åœ¨ç”¨ Grantham è·ç¦»æ¥è¡¡é‡ä¸¤ä¸ªæ°¨åŸºé…¸åºåˆ—ä¹‹é—´çš„å·®å¼‚æ—¶ï¼Œå¹³å‡æ¯ 2.2 ä¸ª Gratham å•ä½çš„å·®å¼‚ï¼Œç›¸å½“äº 1 ä¸ªâ€œæœ‰æ•ˆâ€çš„æ°¨åŸºé…¸ä½ç‚¹å‘ç”Ÿäº†æ”¹å˜**ã€‚è¿™ä¸ªæ¢ç®—æ˜¯ä¸ºäº†è®©æœ€ç»ˆçš„ HEDï¼ˆHLA Evolutionary Divergenceï¼‰å€¼æ›´å…·ç”Ÿç‰©å­¦æ„ä¹‰â€”â€”å®ƒå¯ä»¥è¿‘ä¼¼è¡¨ç¤ºâ€œç­‰ä»·æœ‰å¤šå°‘ä¸ªä½ç‚¹å‘ç”Ÿäº†çªå˜â€ã€‚

---

##### ğŸ”¬ ä¸¾ä¸ªä¾‹å­ï¼š

å‡è®¾ä½ æœ‰ä¸¤ä¸ªæ°¨åŸºé…¸åºåˆ—é•¿åº¦ç›¸åŒï¼ˆæ¯”å¦‚ HLA-A çš„ exon2+3 æ‹¼æ¥ï¼‰ï¼Œå®ƒä»¬çš„æ¯ä¸ªä½ç‚¹ä¸¤ä¸¤æ¯”å¯¹åï¼Œè®¡ç®—å‡ºçš„ Grantham è·ç¦»åŠ èµ·æ¥ä¸ºï¼š

```
æ€» Grantham è·ç¦» = 110
```

æ ¹æ®ç»éªŒæ¢ç®—ç³»æ•°ï¼ˆ2.2ï¼‰ï¼Œä½ å¯ä»¥ä¼°ç®—è¿™ä¸¤ä¸ªåºåˆ—ä¹‹é—´çš„â€œæœ‰æ•ˆæ°¨åŸºé…¸å·®å¼‚æ•°â€æ˜¯ï¼š

```
æœ‰æ•ˆå·®å¼‚ä½ç‚¹ â‰ˆ 110 / 2.2 â‰ˆ 50
```

ä¹Ÿå°±æ˜¯è¯´ï¼Œè™½ç„¶å¯èƒ½æ¯ä¸ªä½ç‚¹çš„å·®å¼‚ç¨‹åº¦ä¸åŒï¼ˆå› ä¸º Grantham è€ƒè™‘äº†ä½“ç§¯ã€ç”µè·ã€ææ€§ç­‰ï¼‰ï¼Œ**ä½†æ€»ä½“æ¥çœ‹ï¼Œè¿™ä¸¤ä¸ªåºåˆ—ä¹‹é—´çš„å·®å¼‚å¤§è‡´ç›¸å½“äº 50 ä¸ªä½ç‚¹å‘ç”Ÿäº†æ›¿æ¢**ã€‚

---

##### ğŸ§ª èƒŒååŸå› ï¼š

è¿™ä¸ªâ€œ2.2â€ä¸æ˜¯æ•°å­¦æ¨å¯¼å‡ºæ¥çš„ï¼Œè€Œæ˜¯æ¥è‡ªäºç»éªŒæ•°æ®çš„æ‹Ÿåˆã€‚ä¾‹å¦‚åœ¨ä¸€äº›ç ”ç©¶ä¸­ï¼ˆå¦‚ 2018 å¹´ Pierini & Lenz æˆ– 2019 å¹´ Chowell ç­‰çš„ç ”ç©¶ï¼‰ï¼Œä»–ä»¬å¯¹ä¸åŒåºåˆ—ä¹‹é—´çš„ Gratham ç´¯ç§¯è·ç¦»è¿›è¡Œäº†å¯¹ç…§åˆ†æï¼Œå‘ç°å°† Gratham æ€»è·ç¦»é™¤ä»¥ 2.2 åï¼Œæ›´å¥½åœ°åæ˜ äº†â€œç­‰æ•ˆçªå˜æ•°é‡â€ä¸å…ç–«å­¦å¤šæ ·æ€§çš„å…³ç³»ã€‚

---

## 20250613

ä»”ç»†æ£€æŸ¥äº†æ–‡çŒ®çš„è„šæœ¬ï¼Œæ–‡çŒ®çš„è„šæœ¬çš„è®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼Œå’Œä¹‹å‰çš„ä»£ç æœ€å¤§çš„ä¸åŒæ˜¯å®ƒé™¤ä»¥äº†åºåˆ—çš„é•¿åº¦:

```python
def calculate_distange(hla1: str, hla2: str, sequences: dict, distance: dict) -> float:
    seq_hla1 = sequences.get(hla1, False)
    seq_hla2 = sequences.get(hla2, False)
    if not seq_hla1 or not seq_hla2:
        return("NA")
    else:
        seq_len = len(seq_hla1)
        dis = 0
        for i in range(seq_len):
            aa1 = seq_hla1[i]
            aa2 = seq_hla2[i]
            dis += distance[aa1][aa2]
        dis = dis / seq_len
        return dis
```

è¿™ä¹Ÿæ˜¯æˆ‘ä¹‹å‰ç®—çš„ç»“æœåå¤§çš„åŸå› ï¼Œä¿®æ­£ä¹‹åæˆ‘ä»¬ç°åœ¨å¯ä»¥é€šè¿‡[compute_HED.py](./compute_HED.py)è¿›è¡Œè®¡ç®—ï¼Œç›¸å…³è®¡ç®—ç»“æœå¦‚ä¸‹ï¼š

![alt text](image-2.png)
![alt text](image-6.png)
æ–‡çŒ®çš„ç»“æœå¦‚ä¸‹æ‰€ç¤º
![alt text](image-5.png)
